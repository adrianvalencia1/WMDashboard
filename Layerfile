#Use an Ubuntu 18.04 base for our staging server
FROM vm/ubuntu:18.04

# To note: Layerfiles create entire VMs, *not* containers!

# Install python
RUN apt-get update && apt-get install -y python3 python3-pip

# Install dependencies from requirements.txt
COPY requirements.txt /root/requirements.txt
RUN pip3 install -r /root/requirements.txt

# Create some files
#RUN echo '<b>some html</b>' > hello.html
#RUN echo '<b>another file</b>' > another.html

# You could also install & start a database:
# RUN apt-get update && apt-get install postgresql

# This line copies the repository to /root in the runner
COPY . .

ENV FLASK_APP=app.py

RUN BACKGROUND python3 app.py
EXPOSE WEBSITE http://localhost:80
# Expose the webserver in the staging server as a secure link.
# Whenever someone clicks the link, we'll load this staging server and forward
# their requests to it.
#RUN BACKGROUND python3 app.py
#EXPOSE WEBSITE http://localhost:80
